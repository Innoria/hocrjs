{"version":3,"sources":["webpack:///webpack/bootstrap febe0ede565682986116","webpack:///./src/browser/viewer.js","webpack:///./src/browser/utils.js"],"names":["defaultConfig","root","debugLevel","fonts","serif","monospace","UnifrakturCook","cssUrl","UnifrakturMaguntia","Cardo","features","backgroundImage","enabled","scaleFont","maxFontSize","minFontSize","wrapClass","disableEmStrong","contentEditable","tooltips","styleId","borders","transparentText","expandToolbar","enableToolbar","rootClass","toolbarId","HocrViewer","config","Object","keys","forEach","k","document","querySelector","parser","window","HocrParser","font","addCssFragment","cache","level","arguments","args","Array","prototype","slice","call","levelToFn","console","apply","query","tag","clauses","title","class","qs","map","cls","indexOf","join","log","context","set","querySelectorAll","terminal","filter","el","container","findByOcrClass","coords","bbox","style","left","top","width","height","minHeight","onoff","time","wrap","createElement","classList","add","appendChild","fontSize","timeEnd","textContent","trim","length","fontFamily","innerHTML","w","h","fontsize","Math","min","remove","ocrClasses","getAttribute","setAttribute","createTextNode","head","page","imageFile","image","onContentEditableInput","ev","warn","target","child","addEventListener","removeAttribute","removeEventListener","toolbar","toggle","feature","substr","toUpperCase","substring","body","toggleExpandToolbar","fontSelect","fontOption","append","selectedFont","options","selectedIndex","onConfigChange","li","checkbox","label","checked","onChange","toggleFeature","zoomSlider","scaleFactor","value","transform","transformOrigin","addToolbar","placeOcrElements","Utils","css","id"],"mappings":"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","file":"hocr-viewer.webpack.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap febe0ede565682986116","/* BEGIN-BANNER -f smmono12 -i ' * ' -C \"2016 Konstantin Baierer\"  -L MIT\n *        █\n *        ▀\n * ▐▙ ▟▌ ██   ▟█▙ █   █ ▟█▙  █▟█▌\n *  █ █   █  ▐▙▄▟▌▜ █ ▛▐▙▄▟▌ █▘\n *  ▜▄▛   █  ▐▛▀▀▘▐▙█▟▌▐▛▀▀▘ █\n *  ▐█▌ ▗▄█▄▖▝█▄▄▌▝█ █▘▝█▄▄▌ █\n *   ▀  ▝▀▀▀▘ ▝▀▀  ▀ ▀  ▝▀▀  ▀\n *\n * Copyright (c) 2016 Konstantin Baierer\n *\n * This software may be modified and distributed under the terms\n * of the MIT license.  See the LICENSE file for details.\n *\n\n * END-BANNER */\nimport Utils from './utils';\n\nexport const defaultConfig = {\n    root: 'body',\n    debugLevel: 1,\n    fonts: {\n        'sans-serif': {},\n        serif: {},\n        monospace: {},\n        UnifrakturCook: {\n            cssUrl: 'https://fonts.googleapis.com/css?family=UnifrakturCook:700',\n        },\n        UnifrakturMaguntia: {\n            cssUrl: 'https://fonts.googleapis.com/css?family=UnifrakturMaguntia',\n        },\n        'Old Standard TT': {\n            cssUrl: 'https://fonts.googleapis.com/css?family=Old+Standard+TT',\n        },\n        Cardo: {\n            cssUrl: 'https://fonts.googleapis.com/css?family=Cardo'\n        },\n        'Noto Serif': {\n            cssUrl: 'https://fonts.googleapis.com/css?family=Noto+Serif:400,400i,700&subset=latin-ext'\n        },\n        'Libre Baskerville': {\n            cssUrl: 'https://fonts.googleapis.com/css?family=Libre+Baskerville:400,400i,700&subset=latin-ext'\n        },\n    },\n    features: {\n        backgroundImage: {\n            enabled: false,\n        },\n        scaleFont: {\n            enabled: false,\n            maxFontSize: 128,\n            minFontSize: 2,\n            wrapClass: 'hocr-viewer-wrap',\n        },\n        disableEmStrong: {\n            enabled: false,\n        },\n        contentEditable: {\n            enabled: false,\n        },\n        tooltips: {\n            enabled: false,\n            styleId: 'hocr-viewer-tooltip-style',\n        },\n        borders: {\n            enabled: true,\n        },\n        transparentText: {\n            enabled: false,\n        },\n    },\n    expandToolbar: true,\n    enableToolbar: true,\n    transparentText: false,\n    rootClass: 'hocr-viewer',\n    toolbarId: 'hocr-viewer-toolbar',\n};\n\nexport class HocrViewer {\n    constructor(config) {\n        this.config = defaultConfig;\n        Object.keys(config || {}).forEach((k) => {\n            // TODO proper conifg\n            this.config[k] = config[k];\n        });\n        this.root = this.config.root;\n        if (typeof this.root === 'string')\n            this.root = document.querySelector(this.root);\n        this.parser = new window.HocrParser(this.config);\n        Object.keys(this.config.fonts).forEach((font) => {\n            var cssUrl = this.config.fonts[font].cssUrl;\n            if (cssUrl) Utils.addCssFragment('hocr-view-font-styles', `@import \"${cssUrl}\";\\n`);\n        });\n        this.cache = {\n            scaleFont: {}\n        };\n    }\n\n    log() {\n        var level = arguments[0];\n        if (level > this.config.debugLevel) return;\n        var args = Array.prototype.slice.call(arguments, [1]);\n        var levelToFn = ['info', 'debug', 'log'];\n        console[levelToFn[level]].apply(console, args);\n    }\n\n    findByOcrClass(query) {\n        query = (query || {});\n\n        // Expect tag\n        query.tag = (query.tag || '*');\n\n        // Arbitrary clauses\n        query.clauses = (query.clauses || '');\n\n        // Return only hocr-elements with a bbox\n        if (query.title) query.clauses += `[title*=\"${query.title}\"]`;\n\n        // Return specific ocr_* / ocrx_* classes\n        query.class = (query.class || '');\n        if (typeof query.class === 'string') query.class = [query.class];\n\n        // Build querySelectorAll query\n        var qs = query.class.map(function(cls) {\n            if (cls.indexOf('ocr') === 0) return cls;\n            if (cls === '') return 'ocr';\n            if (cls.indexOf('x_') !== 0) return `ocr_${cls}`;\n            return `ocr${cls}`;\n        }).map(function(cls) {\n            return `:scope ${query.tag}[class^=\"${cls}\"]${query.clauses}`;\n        }).join(',');\n        this.log(1, \"findByOcrClass:\", qs);\n        var context = (query.context || document.querySelector('.' + this.config.rootClass));\n        var set = Array.prototype.slice.call(context.querySelectorAll(qs));\n\n        // terminal: Return only hocr-elements containing no hocr-elements themselves\n        // container: Opposite\n        if (query.terminal)\n            set = set.filter(function(el) {\n                if (!el.querySelector('*[class^=\"ocr\"]')) return el;\n            });\n        if (query.container)\n            set = set.filter(function(el) {\n                if (el.querySelector('*[class^=\"ocr\"]')) return el;\n            });\n\n        // Arbitrary filter function\n        if (query.filter) {\n            set = set.filter(query.filter);\n        }\n\n        return set;\n    }\n\n    placeOcrElements() {\n        this.findByOcrClass({\n            title: 'bbox'\n        }).forEach((el) => {\n            var coords = this.parser.bbox(el);\n            el.style.left = coords[0] + \"px\";\n            el.style.top = coords[1] + \"px\";\n            el.style.width = coords[2] - coords[0] + \"px\";\n            el.style.height = coords[3] - coords[1] + \"px\";\n        });\n        var coords = this.parser.bbox(document.querySelector('.ocr_page'));\n        document.querySelector('body').style.minHeight = coords[2] + 'px';\n    }\n\n    toggleScaleFont(onoff) {\n        // wrapper element containing wrappers for font-size expansion\n        console.time('toggleScaleFont');\n        var wrap = document.querySelector(`.${this.config.features.scaleFont.wrapClass}`);\n        if (!wrap) {\n            wrap = document.createElement('span');\n            wrap.classList.add(this.config.features.scaleFont.wrapClass);\n            this.root.appendChild(wrap);\n        }\n        if (onoff) {\n            this.findByOcrClass({terminal: true}).forEach((el) => this.scaleFont(el, wrap));\n            // wrap.style.display = 'none';\n        } else {\n            this.findByOcrClass({terminal: true}).forEach((el) => el.style.fontSize = 'initial');\n        }\n        console.timeEnd('toggleScaleFont');\n    }\n\n    scaleFont(el, wrap) {\n        if (el.textContent.trim().length === 0) return;\n        if (!(el.textContent in this.cache.scaleFont)) {\n            // wrap.setAttribute('class', el.getAttribute('class'));\n            // wrap.style.width = '100%';\n            wrap.style.fontFamily = el.style.fontFamily;\n            wrap.innerHTML = el.textContent;\n            var w = 'offsetWidth';\n            var h = 'offsetHeight';\n            var fontsize = Math.min(el[w], el[h]);\n            var min = this.config.features.scaleFont.minFontSize;\n            wrap.style.fontSize = fontsize + 'px';\n            if (fontsize > min && wrap[h] > el[h]) {\n                fontsize -= wrap[h] - el[h];\n                wrap.style.fontSize = fontsize + 'px';\n            }\n            while (fontsize > min && wrap[w] > el[w]) {\n                fontsize -= 1;\n                wrap.style.fontSize = fontsize + 'px';\n            }\n            // if (iterations > 1) console.debug(iterations, el.textContent, wrap[h], el[h], wrap[w], el[w]);\n            this.cache.scaleFont[el.textContent] = fontsize;\n        }\n        el.style.fontSize = this.cache.scaleFont[el.textContent] + 'px';\n    }\n\n    toggleTooltips(onoff) {\n        var style = document.querySelector('#' + this.config.features.tooltips.styleId);\n        if (!onoff) {\n            if (style) style.remove();\n        } else {\n            var ocrClasses = {};\n            for (var el of this.findByOcrClass()) {\n                ocrClasses[el.getAttribute('class')] = true;\n            }\n            this.log(0, \"Detected OCR classes\", Object.keys(ocrClasses));\n            if (!style) {\n                style = document.createElement('style');\n                style.setAttribute('id', this.config.features.tooltips.styleId);\n            }\n            style.appendChild(document.createTextNode(Object.keys(ocrClasses).map((cls) =>\n                `.${this.config.rootClass} .${cls}:hover::before { content: \"${cls}\"; }\\n`\n            ).join(\"\\n\")));\n            document.head.appendChild(style);\n        }\n    }\n\n    toggleBackgroundImage(onoff) {\n        var page = this.root.querySelector('.ocr_page');\n        if (onoff) {\n            this.findByOcrClass({\n                title: 'image'\n            }).forEach((el) => {\n                var imageFile = this.parser.image(el);\n                page.style.backgroundImage = `url(${imageFile})`;\n            });\n        } else {\n            page.style.backgroundImage = '';\n            // delete this.root.style.backgroundImage;\n        }\n    }\n\n    toggleContentEditable(onoff) {\n        var onContentEditableInput = (ev) => {\n            console.warn(\"Scaling of contentEditable is broken right now\");\n            if (this.config.features.scaleFont.enabled) {\n                this.scaleFont(ev.target);\n                this.findByOcrClass({\n                    context: ev.target\n                }).forEach((child) => {\n                    this.scaleFont(child);\n                })\n            }\n        }\n        this.findByOcrClass({\n            class: ['line', 'x_word'],\n            clauses: '',\n        }).forEach((el) => {\n            if (onoff) {\n                el.setAttribute('contentEditable', 'true');\n                el.addEventListener('input', onContentEditableInput);\n            } else {\n                el.removeAttribute('contentEditable');\n                el.removeEventListener('input', onContentEditableInput);\n            }\n        });\n    }\n\n    toggleExpandToolbar(onoff) {\n        this.toolbar.classList.toggle('expanded', onoff);\n    }\n\n    toggleFeature(feature, onoff) {\n        this.root.classList.toggle(`feature-${feature}`, onoff);\n        var toggle = 'toggle' + feature.substr(0, 1).toUpperCase() + feature.substring(1);\n        if (toggle in this) {\n            this.log(0, `Calling this.${toggle}`);\n            this[toggle](onoff);\n        }\n    }\n\n    addToolbar() {\n        this.toolbar = document.querySelector('#' + this.config.toolbarId);\n        if (this.toolbar) return;\n        this.toolbar = document.createElement('div');\n        this.toolbar.setAttribute('id', this.config.toolbarId);\n        this.toolbar.classList.toggle('expanded', this.config.expandToolbar);\n        document.body.appendChild(this.toolbar);\n        this.toolbar.innerHTML = `\n    <div class=\"toggler\">\n        <div class=\"toggler-inner toggler-show\">\n            &gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>&gt;<br/>\n        </div>\n        <div class=\"toggler-inner toggler-hide\">\n            &lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>&lt;<br/>\n        </div>\n    </div>\n    <div class=\"wrapper\">\n        <h2>Font</h2>\n        <select class=\"fontlist\"></select>\n        <h2>Features</h2>\n        <ul class='features'>\n        </ul>\n        <h2>Zoom</h2>\n        <input type='range' class='zoom' min='0' max='500' step='2' value=\"100\"/>\n    </div>`;\n        this.toolbar.querySelector('.toggler').addEventListener('click', (ev) => {\n            this.config.expandToolbar = !this.config.expandToolbar;\n            this.toggleExpandToolbar(this.config.expandToolbar);\n        });\n\n        // fonts\n        var fontSelect = this.toolbar.querySelector('select.fontlist');\n        Object.keys(this.config.fonts).forEach((font) => {\n            var fontOption = document.createElement('option');\n            fontOption.innerHTML = font;\n            fontOption.style.fontSize = 'large';\n            fontOption.style.fontFamily = font;\n            fontSelect.append(fontOption);\n        });\n        fontSelect.addEventListener('change', (ev) => {\n            var selectedFont = ev.target.options[ev.target.selectedIndex].innerHTML;;\n            this.findByOcrClass().forEach((el) => {\n                el.style.fontFamily = selectedFont;\n            });\n            this.onConfigChange();\n        });\n\n        // features\n        Object.keys(this.config.features).forEach((feature) => {\n            var li = document.createElement('li');\n            var checkbox = document.createElement('input');\n            var label = document.createElement('label');\n            li.appendChild(checkbox);\n            li.appendChild(label);\n            this.toolbar.querySelector('.features').appendChild(li);\n\n            label.innerHTML = feature;\n\n            checkbox.setAttribute('type', 'checkbox');\n            checkbox.checked = this.config.features[feature].enabled;\n            li.classList.toggle('checked', checkbox.checked);\n            var onChange = (ev) => {\n                li.classList.toggle('checked', checkbox.checked);\n                this.config.features[feature].enabled = checkbox.checked;\n                this.toggleFeature(feature, checkbox.checked);\n            };\n            li.addEventListener('click', (ev) => {\n                checkbox.checked = !checkbox.checked;\n                // onChange();\n                li.classList.toggle('checked');\n                this.config.features[feature].enabled = checkbox.checked;\n                this.toggleFeature(feature, checkbox.checked);\n            });\n            checkbox.addEventListener('change', onChange);\n        });\n\n        // Zoom\n        var zoomSlider = this.toolbar.querySelector('.zoom');\n        zoomSlider.addEventListener('input', (ev) => {\n            var scaleFactor = ev.target.value / 100.0;\n            var page = this.root.querySelector('.ocr_page');\n            page.style.transform = `scale(${scaleFactor})`;\n            page.style.transformOrigin = 'top left';\n            // console.log();\n        });\n    }\n\n\n    onConfigChange() {\n        Object.keys(this.config.features).forEach((feature) => {\n            this.toggleFeature(feature, this.config.features[feature].enabled);\n        });\n    }\n\n    init() {\n        this.root.classList.add(this.config.rootClass);\n\n        if (this.config.enableToolbar) {\n            this.addToolbar();\n        }\n\n        // place the elements on the page\n        this.placeOcrElements();\n\n        // Events\n        this.onConfigChange();\n        window.addEventListener('resize', () => this.onConfigChange());\n    }\n\n}\nwindow.HocrViewer = HocrViewer;\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/viewer.js","/* BEGIN-BANNER -f smmono12 -i ' * ' -C \"2016 Konstantin Baierer\"  -L MIT\n *             █  ▗▄▖\n *       ▐▌    ▀  ▝▜▌\n * ▐▌ ▐▌▐███  ██   ▐▌  ▗▟██▖\n * ▐▌ ▐▌ ▐▌    █   ▐▌  ▐▙▄▖▘\n * ▐▌ ▐▌ ▐▌    █   ▐▌   ▀▀█▖\n * ▐▙▄█▌ ▐▙▄ ▗▄█▄▖ ▐▙▄ ▐▄▄▟▌\n *  ▀▀▝▘  ▀▀ ▝▀▀▀▘  ▀▀  ▀▀▀\n *\n * Copyright (c) 2016 Konstantin Baierer\n *\n * This software may be modified and distributed under the terms\n * of the MIT license.  See the LICENSE file for details.\n *\n\n * END-BANNER */\nexport default class Utils {\n    static addCssFragment(styleId, css) {\n        var style = document.querySelector(`#${styleId}`);\n        if (!style) {\n            style = document.createElement('style');\n            style.id = styleId;\n            document.head.appendChild(style);\n        }\n        style.appendChild(document.createTextNode(css));\n    }\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/browser/utils.js"],"sourceRoot":""}